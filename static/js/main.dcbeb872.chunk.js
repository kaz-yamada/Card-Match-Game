(this["webpackJsonpcard-match-game"]=this["webpackJsonpcard-match-game"]||[]).push([[0],{28:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(12),c=a.n(r),s=a(2),i=a(7),o=a(5),u=a.n(o),d=a(8),b=a(6),l=a(4),j=a(14),f=a.n(j),O=150,h=250,m="https://picsum.photos",p="IN_PROGRESS",x="LOADING",v="CREATING",g="FINISHED",k="SELECTED",w="MATCHED",C="HIDDEN",y=a(1),S=Object(i.a)({card:{padding:5,borderRadius:5,height:h,width:O,border:"black 5px solid",position:"relative",transition:"all 0.4s linear",transformStyle:"preserve-3d",margin:"5px","& div":{position:"absolute",backfaceVisibility:"hidden"}},selected:{borderColor:"blue",transform:"rotateY(180deg)"},front:{transform:"rotateY(180deg)"},matched:{borderColor:"green",transform:"rotateY(180deg)"},back:{transform:"rotateY(180deg)",top:"25%",left:"35%"}}),N=function(e){var t,a=e.data,r=e.handleClick,c=e.index,i=Object(n.useState)(!1),o=Object(s.a)(i,2),u=o[0],d=o[1],l=a.id,j=a.url,O=a.status,h=S(),m=O===k,p=O===w;return Object(y.jsxs)("div",{className:f()(h.card,(t={},Object(b.a)(t,h.selected,m),Object(b.a)(t,h.matched,p),t)),onClick:function(){O===C&&r(c,l)},"data-testid":"card-root",children:[Object(y.jsx)("div",{className:h.front,children:Object(y.jsx)("img",{src:j,alt:"card",onLoad:function(){d(!0)}})}),Object(y.jsx)("div",{className:h.back,children:!u&&"Loading"})]})},E=function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:for(t=e.sent,a=t.concat(t);a.length>15;)a.pop();return n=a.sort((function(){return.5-Math.random()})),e.abrupt("return",new Promise((function(e,t){e(n)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(m,"/v2/list?page=").concat(t,"&limit=100"),e.next=3,fetch(a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n,r,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],a=new Set,n=Math.floor(10*Math.random())+1,e.next=5,I(n);case 5:for(r=e.sent;a.size<Math.ceil(7.5);)c=Math.floor(Math.random()*r.length)+1,r[c]&&(s=r[c].id,a.has(s)||(a.add(s),t.push({id:s,url:"".concat(m,"/id/").concat(s,"/").concat(O,"/").concat(h),status:C})));return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=E,R=Object(i.a)({board:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",justifyItems:"center"}}),G=function(e){var t=e.gameStatus,a=e.onGameUpdate,r=Object(n.useState)({}),c=Object(s.a)(r,2),i=c[0],o=c[1],j=Object(n.useState)(!1),f=Object(s.a)(j,2),O=f[0],h=f[1],m=Object(n.useState)(null),S=Object(s.a)(m,2),E=S[0],I=S[1],D=Object(n.useState)(null),G=Object(s.a)(D,2),T=G[0],A=G[1],L=Object(n.useState)(0),Y=Object(s.a)(L,2),z=Y[0],F=Y[1],H=Object(n.useRef)(0),P=Object(n.useRef)(new Date),J=Object(n.useRef)(!1),U=R(),B=Object(n.useCallback)((function(){if(E&&T){var e,t=Object(l.a)({},i[E.index]),a=Object(l.a)({},i[T.index]);E.id===T.id?(t.status=w,a.status=w):(t.status=C,a.status=C);var n=Object(l.a)(Object(l.a)({},i),{},(e={},Object(b.a)(e,E.index,t),Object(b.a)(e,T.index,a),e));setTimeout((function(){o(n)}),800),setTimeout(K,800)}}),[i,E,T]),K=function(){I(null),A(null),h(!1)},V=function(e,t){if(!O&&(H.current++,z<2)){var a=z+1,n={index:e,id:t};F(a),1===a?I(n):(A(n),h(!0)),function(e,t){var a=Object(l.a)({},i),n=Object(l.a)({},a[e]);n.status=t,a[e]=n,o(a)}(e,k)}},_=Object(n.useCallback)((function(){o((function(e){var t=Object.keys(i).find((function(e){return i[e].status===C}));if(t){var a=Object(l.a)(Object(l.a)({},i[t]),{},{status:k});return Object(l.a)(Object(l.a)({},i),{},Object(b.a)({},t,a))}return e}))}),[i]),q=Object(n.useCallback)((function(){0===z?14===Object.keys(i).filter((function(e){return i[e].status===w})).length&&a(g,{flips:H.current,time:"".concat((new Date-P.current)/1e3," seconds")}):2===z&&(F(0),B())}),[B,i,z,a,P]),Q=Object(n.useCallback)(Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:t=e.sent,o(t),H.current=0,P.current=new Date,a(p),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[a]);return Object(n.useEffect)((function(){return J.current=!0,J.current&&t===v&&Q(),function(){J.current=!1}}),[t,Q]),Object(n.useEffect)((function(){if(J.current)switch(t){case v:break;case p:q();break;case g:_()}}),[i,q,_,t,a]),t===x?Object(y.jsx)("span",{children:"Loading..."}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("div",{"data-testid":"flip-counter",children:["Flips: ",H.current]}),Object(y.jsx)("div",{className:U.board,children:Object.entries(i).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return Object(y.jsx)(N,{index:a,data:n,handleClick:V},a)}))})]})},T=Object(i.a)({root:{position:"fixed",display:"grid",top:"30%",left:"25%",width:"50%",height:200,background:"aliceblue",justifyItems:"center",alignItems:"center"},button:{background:"white",border:"solid 1px black",padding:"1em 2em"}}),A=function(e){var t=e.onReset,a=e.results,n=T();return Object(y.jsxs)("div",{className:n.root,children:[Object(y.jsx)("div",{children:"Congratulations, you've won!"}),Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{"data-testid":"flips",children:[Object(y.jsx)("b",{children:"Cards flipped:"})," ",a.flips," times"]}),Object(y.jsxs)("div",{"data-testid":"time",children:[Object(y.jsx)("b",{children:"Time taken:"})," ",a.time]})]}),Object(y.jsx)("button",{className:n.button,onClick:function(){t(v)},children:"Play Again"})]})},L=Object(i.a)({header:{textAlign:"center"},footer:{textAlign:"center"},root:{fontFamily:"arial"}}),Y=function(){var e=Object(n.useState)(v),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),i=Object(s.a)(c,2),o=i[0],u=i[1],d=L(),b=function(e,t){r(e),e===g&&u(t)};return Object(y.jsxs)("div",{className:d.root,children:[Object(y.jsx)("header",{className:d.header,children:Object(y.jsx)("h1",{children:"Card Match Game"})}),Object(y.jsxs)("div",{children:[Object(y.jsx)(G,{gameStatus:a,onGameUpdate:b}),a===g&&Object(y.jsx)(A,{onReset:b,results:o})]}),Object(y.jsxs)("footer",{className:d.footer,children:["Created by ",Object(y.jsx)("a",{href:"https://www.kazyamada.com/",children:"Kaz Yamada"})," |"," ",Object(y.jsx)("a",{href:"https://github.com/kaz-yamada/Card-Match-Game",children:"Source"})]})]})};c.a.render(Object(y.jsx)(Y,{}),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.dcbeb872.chunk.js.map